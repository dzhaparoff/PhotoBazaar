!function(window,angular){"use strict";angular.module("ngCollection",[]).factory("$collection",["$filter","$parse",function($filter,$parse){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function guid(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}function checkValue(item,compareFn){return compareFn(item)}function Collection(options){options||(options={}),void 0!==options.comparator&&(this.comparator=options.comparator),this.idAttribute=options.idAttribute||this.idAttribute,this.current=null,this._reset(),this.initialize.apply(this,arguments)}return Collection.prototype={idAttribute:"id",initialize:function(){},add:function(obj,options){options||(options={});var id,sort,existing,index;return sort=options.sort!==!1,index=void 0!==options.index?options.index:this.array.length,obj[this.idAttribute]||(obj[this.idAttribute]=guid()),(existing=this.get(obj))?angular.extend(existing,obj):(id=obj[this.idAttribute],this.hash[id]=obj,this.array.splice(index,0,obj),this.length+=1),sort&&this.sort(),this},addAll:function(objArr,options){options||(options={});for(var sort=options.sort!==!1,i=0;i<objArr.length;i++){var obj=objArr[i];this.add(obj,angular.extend(options,{sort:!1}))}return sort&&this.sort(),this},sort:function(comparator){var comparator=comparator||this.comparator;return comparator&&(this.array=$filter("orderBy")(this.array,comparator)),this},get:function(obj){return null==obj?void 0:this.hash[obj[this.idAttribute]||obj]},find:function(expr,value,deepCompare){var compareFn=expr;if("string"==typeof expr){var parse=$parse(expr);compareFn=function(item){return deepCompare?parse(item)==value:parse(item)===value},compareFn.prototype.value=value,compareFn.prototype.deepCompare=deepCompare}for(var i=0;i<this.array.length;i++)if(checkValue(this.array[i],compareFn))return this.array[i];return void 0},where:function(expr,value,deepCompare){var results=[],compareFn=expr;if("string"==typeof expr){var parse=$parse(expr);compareFn=function(item){return deepCompare?parse(item)==value:parse(item)===value},compareFn.prototype.value=value,compareFn.prototype.deepCompare=deepCompare}for(var i=0;i<this.array.length;i++)checkValue(this.array[i],compareFn)&&results.push(this.array[i]);return results},update:function(obj){var existing;return existing=this.get(obj),existing&&angular.extend(existing,obj),existing||this.add(obj),this},remove:function(obj){var index;return index=this.array.indexOf(obj),-1===index?this:(delete this.hash[obj[this.idAttribute]],this.array.splice(index,1),this.length--,this)},removeAll:function(){for(var i=this.array.length-1;i>=0;i--)this.remove(this.at(i));return this},last:function(){return this.array[this.length-1]},at:function(index){return this.array[index]},size:function(){return this.array.length},all:function(){return this.array},_reset:function(){this.length=0,this.hash={},this.array=[]}},Collection.extend=function(protoProps){var child,parent=this;child=protoProps&&protoProps.hasOwnProperty("constructor")?protoProps.constructor:function(){return parent.apply(this,arguments)};var Surrogate=function(){this.constructor=child};return Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,protoProps&&angular.extend(child.prototype,protoProps),child.extend=parent.extend,child.getInstance=Collection.getInstance,child._super=parent.prototype,child},Collection.getInstance=function(options){return new this(options)},Collection}])}(window,window.angular);